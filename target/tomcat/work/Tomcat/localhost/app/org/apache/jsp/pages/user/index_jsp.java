/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.47
 * Generated at: 2018-07-18 14:56:26 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.pages.user;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class index_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=utf-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\n");
      out.write("<!DOCTYPE html>\n");
      out.write("<html lang=\"en\">\n");
      out.write("<head>\n");
      out.write("    <meta charset=\"UTF-8\">\n");
      out.write("    <title>JS學習</title>\n");
      out.write("    <link rel=\"stylesheet\" href=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/index.css\">\n");
      out.write("    <script src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/jquery.js\"></script>\n");
      out.write("</head>\n");
      out.write("<body>\n");
      out.write("<div class=\"container\">\n");
      out.write("    <div class=\"form\">\n");
      out.write("        <div class=\"first\">\n");
      out.write("            <p>Name: <input id=\"name\" type=\"text\"></p>\n");
      out.write("            <p>Address: <input type=\"text\" id=\"address\"></p>\n");
      out.write("        </div>\n");
      out.write("        <div class=\"second\">\n");
      out.write("            <p>\n");
      out.write("                Sex: <select id=\"sex\">\n");
      out.write("                <option value=\"1\">男</option>\n");
      out.write("                <option value=\"0\">女</option>\n");
      out.write("            </select>\n");
      out.write("            </p>\n");
      out.write("            <p>Email: <input type=\"text\" id=\"email\"></p>\n");
      out.write("        </div>\n");
      out.write("        <div class=\"third\">\n");
      out.write("            <p>Birthday: <input type=\"text\" class=\"birth layui-bg-orange\" id=\"birth\" placeholder=\"^_^\">\n");
      out.write("            </p>\n");
      out.write("            <p>PostCode: <input type=\"text\" id=\"postcode\"></p>\n");
      out.write("            <p id=\"pca\">\n");
      out.write("                城市:\n");
      out.write("                <select class=\"p_val\">\n");
      out.write("                    <option value=\"\"></option>\n");
      out.write("                </select>\n");
      out.write("                <select class=\"c_val\">\n");
      out.write("                    <option value=\"\"></option>\n");
      out.write("                </select>\n");
      out.write("                <select class=\"a_val\">\n");
      out.write("                    <option value=\"\"></option>\n");
      out.write("                </select>\n");
      out.write("            </p>\n");
      out.write("        </div>\n");
      out.write("        <div class=\"third\">\n");
      out.write("            <p>Description: <textarea id=\"description\" cols=\"90\" rows=\"5\"></textarea></p>\n");
      out.write("        </div>\n");
      out.write("\n");
      out.write("        <div class=\"fourth\">\n");
      out.write("            <button id=\"add\" onclick=\"handleAdd()\">Add</button>\n");
      out.write("            <button id=\"delete_all\">Reset</button>\n");
      out.write("        </div>\n");
      out.write("    </div>\n");
      out.write("    <table id=\"tab\">\n");
      out.write("        <thead>\n");
      out.write("        <tr>\n");
      out.write("            <th>ID</th>\n");
      out.write("            <th>Name</th>\n");
      out.write("            <th>Sex</th>\n");
      out.write("            <th>Address</th>\n");
      out.write("            <th>Email</th>\n");
      out.write("            <th>Option</th>\n");
      out.write("        </tr>\n");
      out.write("        </thead>\n");
      out.write("        <tbody></tbody>\n");
      out.write("    </table>\n");
      out.write("    <div class=\"fourth\">\n");
      out.write("        <button id=\"prev\" onclick=\"prev()\">Prev</button>\n");
      out.write("        <button id=\"next\" onclick=\"next()\">Next</button>\n");
      out.write("    </div>\n");
      out.write("    <div class=\"mask\" onclick=\"hide()\">\n");
      out.write("        <div class=\"tk\" id=\"tk\">\n");
      out.write("            <div id=\"data\">\n");
      out.write("            </div>\n");
      out.write("            <div class=\"fourth\">\n");
      out.write("                <button onclick=\"hide()\">Back</button>\n");
      out.write("            </div>\n");
      out.write("        </div>\n");
      out.write("    </div>\n");
      out.write("</div>\n");
      out.write("<script src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/laydate.js\"></script> <!-- 改成你的路径 -->\n");
      out.write("<script>\n");
      out.write("    // 日期選擇\n");
      out.write("    lay('#version').html('-v' + laydate.v);\n");
      out.write("    laydate.render({\n");
      out.write("        elem: '#birth', //指定元素\n");
      out.write("        lang: 'en',\n");
      out.write("        theme: 'green'\n");
      out.write("    });\n");
      out.write("\n");
      out.write("    var $_name = $(\"#name\");\n");
      out.write("    var $address = $(\"#address\");\n");
      out.write("    var $sex = $(\"#sex\");\n");
      out.write("    var $email = $(\"#email\");\n");
      out.write("    var $tab = $($(\"#tab>tbody\")[0]);\n");
      out.write("    var $birthday = $(\"#birth\");\n");
      out.write("    var $postcode = $(\"#postcode\");\n");
      out.write("    var $description = $(\"#description\");\n");
      out.write("\n");
      out.write("    var $_next = $(\"#next\");\n");
      out.write("    var $_prev = $(\"#prev\");\n");
      out.write("    var $mask = $(\".mask\");\n");
      out.write("    var $tk = $($(\"#data\")[0]);\n");
      out.write("\n");
      out.write("    var $pcaSelect = $(\"#pca select\");\n");
      out.write("\n");
      out.write("    let next_page_url = \"\";\n");
      out.write("    let prev_page_url = \"\";\n");
      out.write("    let current_page = 1;\n");
      out.write("\n");
      out.write("    $(document).ready(function () {\n");
      out.write("\n");
      out.write("        render();\n");
      out.write("\n");
      out.write("        $(\"#delete_all\").click(function () {\n");
      out.write("            $_name.val(\"\");\n");
      out.write("            $address.val(\"\");\n");
      out.write("            $email.val(\"\");\n");
      out.write("            $sex.val(\"\");\n");
      out.write("            $birthday.val(\"\");\n");
      out.write("            $postcode.val(\"\");\n");
      out.write("            $description.val(\"\");\n");
      out.write("        });\n");
      out.write("    });\n");
      out.write("\n");
      out.write("    function handleAdd() {\n");
      out.write("        var p_val = $(\".p_val\").find(\"option:selected\").val();\n");
      out.write("        var c_val = $(\".c_val\").find(\"option:selected\").val();\n");
      out.write("        var a_val = $(\".a_val\").find(\"option:selected\").val();\n");
      out.write("        var p_text = $(\".p_val\").find(\"option:selected\").text();\n");
      out.write("        var c_text = $(\".c_val\").find(\"option:selected\").text();\n");
      out.write("        var a_text = $(\".a_val\").find(\"option:selected\").text();\n");
      out.write("\n");
      out.write("        var formData = {\n");
      out.write("            name: $(\"#name\").val(),\n");
      out.write("            sex: parseInt($(\"#sex\").val()),\n");
      out.write("            address: $(\"#address\").val(),\n");
      out.write("            email: $(\"#email\").val(),\n");
      out.write("            birthday: $(\"#birth\").val(),\n");
      out.write("            postcode: $(\"#postcode\").val(),\n");
      out.write("            description: $(\"#description\").val(),\n");
      out.write("            province_id: parseInt(p_val),\n");
      out.write("            province: p_text,\n");
      out.write("            city_id: parseInt(c_val),\n");
      out.write("            city: c_text,\n");
      out.write("            area_id: parseInt(a_val),\n");
      out.write("            area: a_text,\n");
      out.write("        };\n");
      out.write("        $.ajax({\n");
      out.write("            url: \"http://localhost:8090/app/users/store\",\n");
      out.write("            method: \"post\",\n");
      out.write("            contentType: \"application/json;charset utf-8\",\n");
      out.write("            data: JSON.stringify(formData),\n");
      out.write("            dataType: \"json\",\n");
      out.write("            success: function () {\n");
      out.write("                render();\n");
      out.write("            }\n");
      out.write("        });\n");
      out.write("    }\n");
      out.write("\n");
      out.write("    function del(i) {\n");
      out.write("        $.ajax({\n");
      out.write("            url: \"http://localhost:8090/app/users/delete/\" + i,\n");
      out.write("            method: \"delete\",\n");
      out.write("            success: function () {\n");
      out.write("                prev_page_url = prev_page_url.replace(/page=[\\d]+/, \"page=\" + current_page);\n");
      out.write("                render(prev_page_url);\n");
      out.write("            }\n");
      out.write("        });\n");
      out.write("    }\n");
      out.write("\n");
      out.write("    function render(url) {\n");
      out.write("        var str = \"\";\n");
      out.write("        url = url ? url : \"http://localhost:8090/app/users/index\";\n");
      out.write("        $.get(url, function (data) {\n");
      out.write("            var meta = data['meta'];\n");
      out.write("            data = data['data'];\n");
      out.write("            for (var i in data) {\n");
      out.write("                str = str + \"<tr><td>\" + data[i].id + \"</td><td>\" + data[i].name + \"</td><td>\" + (data[i].sex == \"1\" ? \"男\" : \"女\") + \"</td><td>\" + data[i].address + \"</td><td>\" + data[i].email + \"</td><td><button id='delete' onclick='del(\" + data[i].id + \")'>Delete</button><button id='detail' onclick='detail(\" + data[i].id + \")'>Detail</button></td></tr>\";\n");
      out.write("            }\n");
      out.write("            $tab.html(str);\n");
      out.write("            $_next.attr('disabled', meta.next_page_url === \"\");\n");
      out.write("            $_prev.attr('disabled', meta.prev_page_url === \"\");\n");
      out.write("            next_page_url = meta.next_page_url;\n");
      out.write("            prev_page_url = meta.prev_page_url;\n");
      out.write("            current_page = meta.current_page;\n");
      out.write("        });\n");
      out.write("    }\n");
      out.write("\n");
      out.write("    function prev() {\n");
      out.write("        render(prev_page_url);\n");
      out.write("    }\n");
      out.write("\n");
      out.write("    function next() {\n");
      out.write("        render(next_page_url);\n");
      out.write("    }\n");
      out.write("\n");
      out.write("    function show() {\n");
      out.write("        $mask.show('fast');\n");
      out.write("    }\n");
      out.write("\n");
      out.write("    function hide() {\n");
      out.write("        $mask.hide('fast');\n");
      out.write("    }\n");
      out.write("\n");
      out.write("    function detail(i) {\n");
      out.write("        let content = \"\";\n");
      out.write("        show();\n");
      out.write("        $.get(\"http://localhost:8090/app/users/detail/\" + i, function (data) {\n");
      out.write("            content += \"<p>Name：\" + (data.name) + \"</p><p>Sex：\" + (data.sex == \"1\" ? \"男\" : \"女\") + \"</p>\";\n");
      out.write("            content += \"<p>Province： \" + (data.province) + \"</p><p>City：\" + (data.city) + \"</p>\";\n");
      out.write("            content += \"<p>Area： \" + (data.area) + \"<p>Address： \" + (data.address) + \"</p><p>Email：\" + (data.email) + \"</p>\";\n");
      out.write("            content += \"<p>Birthday： \" + (data.birthday) + \"</p><p>PostCode：\" + (data.postcode) + \"</p>\";\n");
      out.write("            content += \"<p>Description： \" + (data.description) + \"</p>\";\n");
      out.write("            content += \"<p>Created_at： \" + (data.created_at) + \"</p>\";\n");
      out.write("            content += \"<p>Updated_at： \" + (data.updated_at) + \"</p>\";\n");
      out.write("            $tk.html(content);\n");
      out.write("        });\n");
      out.write("    }\n");
      out.write("\n");
      out.write("    function setPca(parent_id = 0, $select) {\n");
      out.write("        $.get(\" http://59.111.58.150:8102/api/region?parent_id=\" + parent_id, function (data) {\n");
      out.write("            var option = '<option></option>';\n");
      out.write("            for (var i in data) {\n");
      out.write("                option += \"<option value='\" + data[i].id + \" ' data-label='\" + data[i].name + \"'>\" + data[i].name + \"</option>\"\n");
      out.write("            }\n");
      out.write("            $select.html(option);\n");
      out.write("        });\n");
      out.write("    }\n");
      out.write("\n");
      out.write("    $pcaSelect.change(function () {\n");
      out.write("        setPca($(this).val(), $(this).next())\n");
      out.write("    });\n");
      out.write("    setPca(0, $pcaSelect.first())\n");
      out.write("\n");
      out.write("</script>\n");
      out.write("</body>\n");
      out.write("</html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
